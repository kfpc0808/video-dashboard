<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ì˜ìƒì‘ì—… í†µí•© ëŒ€ì‹œë³´ë“œ</title>
<link href="https://cdnjs.cloudflare.com/ajax/libs/pretendard/1.3.9/static/pretendard.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
<style>
:root {
  --primary: #1B2A4A;
  --accent: #3B82F6;
  --accent-hover: #2563EB;
  --success: #10B981;
  --warning: #F59E0B;
  --danger: #EF4444;
  --bg: #F0F2F5;
  --card-bg: #FFFFFF;
  --text: #1F2937;
  --text-sub: #6B7280;
  --border: #E5E7EB;
  --sidebar-w: 260px;
  --header-h: 60px;
  --radius: 12px;
  --shadow: 0 1px 3px rgba(0,0,0,0.08);
  --shadow-lg: 0 4px 12px rgba(0,0,0,0.1);
}
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Pretendard',-apple-system,sans-serif;background:var(--bg);color:var(--text);min-height:100vh;}

/* === SIDEBAR === */
.sidebar{position:fixed;left:0;top:0;width:var(--sidebar-w);height:100vh;background:var(--primary);color:#fff;z-index:100;display:flex;flex-direction:column;transition:transform .3s;}
.sidebar-logo{padding:20px 24px;border-bottom:1px solid rgba(255,255,255,.1);}
.sidebar-logo h1{font-size:15px;font-weight:700;line-height:1.5;}
.sidebar-logo span{font-size:11px;color:rgba(255,255,255,.45);display:block;margin-top:4px;}
.sidebar-nav{flex:1;padding:12px;overflow-y:auto;}
.nav-item{display:flex;align-items:center;gap:12px;padding:12px 16px;border-radius:8px;cursor:pointer;font-size:14px;font-weight:500;color:rgba(255,255,255,.65);transition:.2s;margin-bottom:2px;}
.nav-item:hover{background:rgba(255,255,255,.08);color:#fff;}
.nav-item.active{background:var(--accent);color:#fff;font-weight:600;}
.nav-item i{width:20px;text-align:center;font-size:15px;}

/* === HEADER === */
.header{position:fixed;top:0;left:var(--sidebar-w);right:0;height:var(--header-h);background:var(--card-bg);border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;padding:0 24px;z-index:90;}
.header-left{display:flex;align-items:center;gap:14px;}
.menu-toggle{display:none;background:none;border:none;font-size:20px;color:var(--text);cursor:pointer;}
.header-title{font-size:16px;font-weight:600;}
.header-right{display:flex;align-items:center;gap:10px;flex-wrap:wrap;}
.month-sel{display:flex;align-items:center;gap:6px;background:var(--bg);border-radius:8px;padding:5px 10px;}
.month-sel button{background:none;border:none;cursor:pointer;color:var(--text-sub);font-size:14px;padding:4px;}
.month-sel button:hover{color:var(--accent);}
.month-sel span{font-size:14px;font-weight:600;min-width:100px;text-align:center;}

/* === MAIN === */
.main{margin-left:var(--sidebar-w);margin-top:var(--header-h);padding:24px;min-height:calc(100vh - var(--header-h));}

/* === CARDS === */
.card{background:var(--card-bg);border-radius:var(--radius);box-shadow:var(--shadow);padding:20px;margin-bottom:16px;}
.card-title{font-size:15px;font-weight:700;margin-bottom:14px;display:flex;align-items:center;gap:8px;}
.card-title i{color:var(--accent);}

/* === TABLE === */
.table-wrap{overflow-x:auto;}
table{width:100%;border-collapse:collapse;font-size:13px;}
thead th{background:#F8F9FB;padding:9px 10px;text-align:left;font-weight:600;font-size:12px;color:var(--text-sub);border-bottom:2px solid var(--border);white-space:nowrap;}
tbody td{padding:9px 10px;border-bottom:1px solid var(--border);vertical-align:middle;}
tbody tr:hover{background:#F8FAFC;}
th.center,td.center{text-align:center;}

/* === BADGES === */
.badge{display:inline-block;padding:3px 10px;border-radius:20px;font-size:11px;font-weight:600;}
.badge-complete{background:#D1FAE5;color:#065F46;}
.badge-pending{background:#FEF3C7;color:#92400E;}
.badge-cancel{background:#FEE2E2;color:#991B1B;}
.b-field{display:inline-block;padding:2px 8px;border-radius:4px;font-size:11px;font-weight:600;}
.b-ì„¸ë¬´{background:#DBEAFE;color:#1E40AF;}.b-ë…¸ë¬´{background:#FCE7F3;color:#9D174D;}.b-íŠ¹í—ˆ{background:#F3E8FF;color:#6B21A8;}
.b-ë²•ë¥ {background:#FEF3C7;color:#92400E;}.b-ê°œì¸{background:#D1FAE5;color:#065F46;}.b-ë²•ì¸{background:#E0E7FF;color:#3730A3;}
.b-ë¶€ë™ì‚°{background:#FFEDD5;color:#9A3412;}.b-ì •ì±…ìê¸ˆ{background:#CFFAFE;color:#155E75;}.b-ê¸°ì—…ì¸ì¦{background:#FDE68A;color:#78350F;}
.b-ê´€ì„¸{background:#E9D5FF;color:#5B21B6;}.b-ì»¤ë®¤ë‹ˆì¼€ì´ì…˜{background:#FBCFE8;color:#831843;}.b-ë¹„ìš©ì ˆê°{background:#A7F3D0;color:#064E3B;}
/* Category badges */
.cat-badge{display:inline-block;padding:3px 10px;border-radius:4px;font-size:11px;font-weight:700;}
.cat-íŠ¹ê¸‰ë³´ê³ ì„œ{background:#1E40AF;color:#fff;}
.cat-ì´ìŠˆë¸Œë¦¬í•‘{background:#D97706;color:#fff;}
/* Gubun badges */
.gub-ë²•ì¸{background:#E0E7FF;color:#3730A3;display:inline-block;padding:2px 8px;border-radius:4px;font-size:11px;font-weight:600;}
.gub-ê°œì¸{background:#D1FAE5;color:#065F46;display:inline-block;padding:2px 8px;border-radius:4px;font-size:11px;font-weight:600;}

/* === CHECK ICONS === */
.chk{font-size:14px;}.chk-y{color:var(--success);}.chk-n{color:#D1D5DB;}

/* === SUMMARY === */
.summary-row{display:flex;gap:10px;margin-bottom:14px;flex-wrap:wrap;}
.sum-item{background:var(--card-bg);padding:9px 16px;border-radius:8px;font-size:13px;box-shadow:var(--shadow);display:flex;align-items:center;gap:6px;}
.sum-item strong{font-weight:700;font-size:16px;}
.sum-item.a-blue strong{color:var(--accent);}.sum-item.a-green strong{color:var(--success);}
.sum-item.a-yellow strong{color:var(--warning);}.sum-item.a-red strong{color:var(--danger);}
.sum-item.bordered{border-left:3px solid var(--accent);padding-left:14px;}
.sum-item.bordered-g{border-left:3px solid var(--success);padding-left:14px;}

/* === FILTER === */
.filter-bar{display:flex;gap:8px;margin-bottom:14px;flex-wrap:wrap;align-items:center;}
.f-select{padding:6px 12px;border:1px solid var(--border);border-radius:6px;font-size:13px;font-family:inherit;background:#fff;cursor:pointer;}

/* === BOARD === */
.board-list{list-style:none;}
.board-item{padding:14px 16px;border-bottom:1px solid var(--border);cursor:pointer;display:flex;align-items:center;gap:12px;transition:background .15s;}
.board-item:hover{background:#F8FAFC;}
.board-item-field{flex-shrink:0;}
.board-item-title{flex:1;font-size:14px;font-weight:500;}
.board-item-date{font-size:12px;color:var(--text-sub);flex-shrink:0;}

/* === MODAL === */
.modal-overlay{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.4);z-index:200;justify-content:center;align-items:center;}
.modal-overlay.active{display:flex;}
.modal-content{background:#fff;border-radius:var(--radius);width:90%;max-width:600px;max-height:80vh;overflow-y:auto;padding:28px;box-shadow:var(--shadow-lg);}
.modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;}
.modal-header h3{font-size:18px;font-weight:700;}
.modal-close{background:none;border:none;font-size:22px;cursor:pointer;color:var(--text-sub);padding:4px;}
.modal-close:hover{color:var(--text);}
.modal-body p{font-size:14px;line-height:1.7;white-space:pre-wrap;}
.modal-meta{display:flex;gap:12px;margin-bottom:14px;font-size:13px;color:var(--text-sub);}

/* === CONTENT CARDS (ê²Œì‹œì˜ˆì •) === */
.content-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(340px,1fr));gap:14px;}
.c-card{background:#fff;border-radius:10px;box-shadow:var(--shadow);padding:16px;border-left:4px solid var(--accent);transition:transform .15s,box-shadow .15s;}
.c-card:hover{transform:translateY(-2px);box-shadow:var(--shadow-lg);}
.c-card-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;}
.c-card-date{font-size:12px;color:var(--text-sub);font-weight:600;}
.c-card-title{font-size:14px;font-weight:600;margin-bottom:10px;line-height:1.4;}
.c-card-meta{display:flex;gap:6px;flex-wrap:wrap;align-items:center;margin-bottom:10px;}
.c-card-meta span{font-size:11px;color:var(--text-sub);}
.c-card-checks{display:flex;gap:12px;font-size:11px;color:var(--text-sub);border-top:1px solid var(--border);padding-top:8px;margin-top:4px;}
.c-card-checks .ci{display:flex;align-items:center;gap:3px;}
.c-card.border-íŠ¹ê¸‰ë³´ê³ ì„œ{border-left-color:#1E40AF;}
.c-card.border-ì´ìŠˆë¸Œë¦¬í•‘{border-left-color:#D97706;}

.view-toggle{display:flex;gap:4px;background:var(--bg);border-radius:8px;padding:3px;}
.vt-btn{padding:6px 12px;border:none;border-radius:6px;font-size:12px;font-weight:500;cursor:pointer;background:transparent;color:var(--text-sub);transition:.2s;}
.vt-btn.active{background:var(--accent);color:#fff;}

/* === SECTION === */
.section{display:none;}.section.active{display:block;}

/* === SETTINGS === */
.settings-panel{display:none;position:fixed;top:0;right:0;width:420px;max-width:100vw;height:100vh;background:#fff;box-shadow:-4px 0 20px rgba(0,0,0,.1);z-index:200;padding:24px;overflow-y:auto;}
.settings-panel.active{display:block;}
.settings-panel h3{font-size:16px;font-weight:700;margin-bottom:20px;}
.s-group{margin-bottom:18px;}
.s-group label{display:block;font-size:13px;font-weight:600;margin-bottom:5px;color:var(--text-sub);}
.s-group input,.s-group textarea{width:100%;padding:9px 12px;border:1px solid var(--border);border-radius:8px;font-size:14px;font-family:inherit;}
.s-group small{font-size:11px;color:var(--text-sub);display:block;margin-top:3px;}
.btn{padding:10px 20px;border:none;border-radius:8px;font-size:14px;font-weight:600;cursor:pointer;transition:.2s;}
.btn-primary{background:var(--accent);color:#fff;}.btn-primary:hover{background:var(--accent-hover);}
.btn-secondary{background:var(--bg);color:var(--text);}.btn-secondary:hover{background:var(--border);}
.btn-sm{padding:6px 14px;font-size:12px;}
.settings-overlay{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.3);z-index:190;}
.settings-overlay.active{display:block;}
.conn-status{display:flex;align-items:center;gap:5px;font-size:11px;padding:5px 10px;border-radius:6px;}
.conn-status.ok{background:#D1FAE5;color:#065F46;}
.conn-status.fail{background:#FEE2E2;color:#991B1B;}
.conn-dot{width:6px;height:6px;border-radius:50%;}
.ok .conn-dot{background:#10B981;}.fail .conn-dot{background:#EF4444;}
a.url-link{color:var(--accent);text-decoration:none;font-size:12px;}a.url-link:hover{text-decoration:underline;}
.empty-state{text-align:center;padding:50px 20px;color:var(--text-sub);}
.empty-state i{font-size:36px;margin-bottom:10px;opacity:.3;}
.empty-state p{font-size:14px;}
.sidebar-overlay{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.3);z-index:99;}
.sidebar-overlay.active{display:block;}
.tab-group{display:flex;gap:4px;background:var(--bg);border-radius:8px;padding:3px;margin-bottom:14px;}
.tab-btn{padding:7px 16px;border:none;border-radius:6px;font-size:13px;font-weight:500;cursor:pointer;background:transparent;color:var(--text-sub);transition:.2s;}
.tab-btn.active{background:var(--accent);color:#fff;}

@media(max-width:768px){
  .sidebar{transform:translateX(-100%);}.sidebar.open{transform:translateX(0);}
  .header{left:0;padding:0 14px;}.main{margin-left:0;padding:14px;}
  .menu-toggle{display:block;}.content-grid{grid-template-columns:1fr;}
  .settings-panel{width:100%;}table{font-size:12px;}thead th,tbody td{padding:7px 6px;}
  .summary-row{gap:6px;}.sum-item{padding:7px 10px;font-size:12px;}
}
</style>
</head>
<body>

<div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

<aside class="sidebar" id="sidebar">
  <div class="sidebar-logo">
    <h1>ì˜ìƒì‘ì—… í†µí•© ëŒ€ì‹œë³´ë“œ<br>ê´€ë¦¬ ì‹œìŠ¤í…œ</h1>
    <span>Video Production Dashboard</span>
  </div>
  <nav class="sidebar-nav">
    <div class="nav-item active" data-section="schedule" onclick="go('schedule')"><i class="fas fa-calendar-alt"></i> ê²Œì‹œì˜ˆì • ì½˜í…ì¸ </div>
    <div class="nav-item" data-section="filming" onclick="go('filming')"><i class="fas fa-video"></i> ì›”ê°„ ì˜ìƒì¤€ë¹„í˜„í™©</div>
    <div class="nav-item" data-section="editing" onclick="go('editing')"><i class="fas fa-film"></i> ì›”ê°„ í¸ì§‘í˜„í™©</div>
    <div class="nav-item" data-section="upload" onclick="go('upload')"><i class="fas fa-upload"></i> ì˜ìƒ ì—…ë¡œë“œí˜„í™©</div>
    <div class="nav-item" data-section="board" onclick="go('board')"><i class="fas fa-clipboard-list"></i> ì˜ìƒì—…ë¬´ê´€ë ¨ê²Œì‹œíŒ</div>
  </nav>
</aside>

<header class="header">
  <div class="header-left">
    <button class="menu-toggle" onclick="toggleSidebar()"><i class="fas fa-bars"></i></button>
    <span class="header-title" id="headerTitle">ê²Œì‹œì˜ˆì • ì½˜í…ì¸ </span>
  </div>
  <div class="header-right">
    <div class="month-sel">
      <button onclick="chgMonth(-1)"><i class="fas fa-chevron-left"></i></button>
      <span id="monthDisp">2026ë…„ 3ì›”</span>
      <button onclick="chgMonth(1)"><i class="fas fa-chevron-right"></i></button>
    </div>
    <div class="conn-status fail" id="connSt"><div class="conn-dot"></div><span>ë¯¸ì—°ê²°</span></div>
    <button class="btn btn-sm btn-secondary" onclick="openSettings()"><i class="fas fa-cog"></i> ì„¤ì •</button>
  </div>
</header>

<main class="main">

<!-- ========== 1. ê²Œì‹œì˜ˆì • ì½˜í…ì¸  ========== -->
<div class="section active" id="sec-schedule">
  <div class="summary-row" id="schSum"></div>
  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:14px;flex-wrap:wrap;gap:8px;">
    <div class="filter-bar" style="margin-bottom:0;">
      <select class="f-select" id="schCatF" onchange="renderSchedule()">
        <option value="all">ì „ì²´ ì¹´í…Œê³ ë¦¬</option>
        <option value="íŠ¹ê¸‰ë³´ê³ ì„œ">íŠ¹ê¸‰ë³´ê³ ì„œ</option>
        <option value="ì´ìŠˆë¸Œë¦¬í•‘">ì´ìŠˆë¸Œë¦¬í•‘</option>
      </select>
      <select class="f-select" id="schGubF" onchange="renderSchedule()">
        <option value="all">ì „ì²´ êµ¬ë¶„</option>
        <option value="ë²•ì¸">ë²•ì¸</option>
        <option value="ê°œì¸">ê°œì¸</option>
      </select>
    </div>
    <div class="view-toggle">
      <button class="vt-btn active" data-view="card" onclick="schView('card')"><i class="fas fa-th-large"></i> ì¹´ë“œ</button>
      <button class="vt-btn" data-view="list" onclick="schView('list')"><i class="fas fa-list"></i> ë¦¬ìŠ¤íŠ¸</button>
    </div>
  </div>
  <div id="schCardWrap"><div class="content-grid" id="schCards"></div></div>
  <div id="schListWrap" style="display:none;">
    <div class="card" style="padding:0 0 8px 0;">
      <div class="table-wrap"><table><thead><tr>
        <th>ê²Œì‹œì˜ˆì •ì¼</th><th>ì¹´í…Œê³ ë¦¬</th><th>êµ¬ë¶„</th><th>ì œëª©</th><th class="center">ì˜ìƒ</th><th class="center">ì˜¤ë””ì˜¤</th><th class="center">HTML</th><th class="center">PDF</th><th class="center">PPT</th><th class="center">ê²Œì‹œì™„ë£Œ</th>
      </tr></thead><tbody id="schTbl"></tbody></table></div>
    </div>
  </div>
</div>

<!-- ========== 2. ì›”ê°„ ì˜ìƒì¤€ë¹„í˜„í™© ========== -->
<div class="section" id="sec-filming">
  <div class="summary-row" id="filmSum"></div>
  <div class="filter-bar">
    <select class="f-select" id="filmFieldF" onchange="renderFilming()"><option value="all">ì „ì²´ ë¶„ì•¼</option></select>
    <select class="f-select" id="filmGubF" onchange="renderFilming()"><option value="all">ì „ì²´ êµ¬ë¶„</option><option value="ë²•ì¸">ë²•ì¸</option><option value="ê°œì¸">ê°œì¸</option></select>
  </div>
  <div class="card"><div class="card-title"><i class="fas fa-video"></i> ì›”ê°„ ì˜ìƒì¤€ë¹„í˜„í™©</div>
    <div class="table-wrap"><table><thead><tr>
      <th>ì˜ìƒí™•ë³´ì˜ˆì •ì¼</th><th>ë¶„ì•¼</th><th>êµ¬ë¶„</th><th>ì „ë¬¸ê°€</th><th>ì˜ìƒ ì œëª©</th><th>ì¤€ë¹„ìƒíƒœ</th><th>ì˜ìƒì—…ë¡œë“œì¼</th><th>ë¹„ê³ </th>
    </tr></thead><tbody id="filmTbl"></tbody></table></div>
  </div>
</div>

<!-- ========== 3. ì›”ê°„ í¸ì§‘í˜„í™© ========== -->
<div class="section" id="sec-editing">
  <div class="summary-row" id="editSum"></div>
  <div class="filter-bar">
    <select class="f-select" id="editFieldF" onchange="renderEditing()"><option value="all">ì „ì²´ ë¶„ì•¼</option></select>
    <select class="f-select" id="editGubF" onchange="renderEditing()"><option value="all">ì „ì²´ êµ¬ë¶„</option><option value="ë²•ì¸">ë²•ì¸</option><option value="ê°œì¸">ê°œì¸</option></select>
  </div>
  <div class="card"><div class="card-title"><i class="fas fa-film"></i> ì›”ê°„ í¸ì§‘í˜„í™©</div>
    <div class="table-wrap"><table><thead><tr>
      <th>ì˜ìƒí™•ë³´ì¼</th><th>ë¶„ì•¼</th><th>êµ¬ë¶„</th><th>ì „ë¬¸ê°€</th><th>ì˜ìƒ ì œëª©</th><th>í¸ì§‘ì™„ë£Œì¼</th><th>ì˜ìƒì—…ë¡œë“œì¼</th><th>ë¹„ê³ </th>
    </tr></thead><tbody id="editTbl"></tbody></table></div>
  </div>
</div>

<!-- ========== 4. ì˜ìƒ ì—…ë¡œë“œí˜„í™© ========== -->
<div class="section" id="sec-upload">
  <div class="summary-row" id="uplSum"></div>
  <div class="filter-bar">
    <select class="f-select" id="uplFieldF" onchange="renderUpload()"><option value="all">ì „ì²´ ë¶„ì•¼</option></select>
    <select class="f-select" id="uplGubF" onchange="renderUpload()"><option value="all">ì „ì²´ êµ¬ë¶„</option><option value="ë²•ì¸">ë²•ì¸</option><option value="ê°œì¸">ê°œì¸</option></select>
  </div>
  <div class="card"><div class="card-title"><i class="fas fa-upload"></i> ë‹¹ì›” ì˜ìƒ ì—…ë¡œë“œ í˜„í™©</div>
    <div class="table-wrap"><table><thead><tr>
      <th>ì—…ë¡œë“œì¼</th><th>ì˜ìƒí™•ë³´ì¼</th><th>ë¶„ì•¼</th><th>êµ¬ë¶„</th><th>ì£¼ì œ</th><th>ì „ë¬¸ê°€</th><th>ì†Œì†</th><th>ì—…ë¡œë“œì‚¬ì´íŠ¸</th><th>URL</th>
    </tr></thead><tbody id="uplTbl"></tbody></table></div>
  </div>
</div>

<!-- ========== 5. ì˜ìƒì—…ë¬´ê´€ë ¨ê²Œì‹œíŒ ========== -->
<div class="section" id="sec-board">
  <div class="card"><div class="card-title"><i class="fas fa-clipboard-list"></i> ì˜ìƒì—…ë¬´ê´€ë ¨ê²Œì‹œíŒ</div>
    <ul class="board-list" id="boardList"><li class="empty-state"><i class="fas fa-inbox"></i><p>ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</p></li></ul>
  </div>
</div>

</main>

<!-- Board Modal -->
<div class="modal-overlay" id="boardModal">
  <div class="modal-content">
    <div class="modal-header"><h3 id="mTitle"></h3><button class="modal-close" onclick="closeModal()">&times;</button></div>
    <div class="modal-meta"><span id="mField"></span><span id="mDate"></span></div>
    <div class="modal-body"><p id="mContent"></p></div>
  </div>
</div>

<!-- Settings -->
<div class="settings-overlay" id="setOverlay" onclick="closeSettings()"></div>
<div class="settings-panel" id="setPanel">
  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
    <h3 style="margin:0;">âš™ï¸ ì„¤ì •</h3>
    <button class="modal-close" onclick="closeSettings()">&times;</button>
  </div>

  <div class="s-group"><label>Google Sheets API í‚¤</label><input type="text" id="cfgApiKey" placeholder="AIzaSy..."></div>
  <div class="s-group"><label>ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ID</label><input type="text" id="cfgSheetId" placeholder="URLì˜ /d/ ì™€ /edit ì‚¬ì´ ë¬¸ìì—´"><small>ì‹œíŠ¸ URL: https://docs.google.com/spreadsheets/d/<b>ì—¬ê¸°</b>/edit</small></div>
  <div class="s-group"><label>ì‹œíŠ¸ íƒ­ ì´ë¦„ (ê¸°ë³¸ê°’ ê¶Œì¥)</label>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:6px;">
      <input type="text" id="snSchedule" value="ê²Œì‹œì˜ˆì •ì½˜í…ì¸ " placeholder="ê²Œì‹œì˜ˆì •ì½˜í…ì¸ ">
      <input type="text" id="snFilming" value="ì˜ìƒì¤€ë¹„í˜„í™©" placeholder="ì˜ìƒì¤€ë¹„í˜„í™©">
      <input type="text" id="snEditing" value="í¸ì§‘í˜„í™©" placeholder="í¸ì§‘í˜„í™©">
      <input type="text" id="snUpload" value="ì—…ë¡œë“œí˜„í™©" placeholder="ì—…ë¡œë“œí˜„í™©">
      <input type="text" id="snBoard" value="ê²Œì‹œíŒ" placeholder="ê²Œì‹œíŒ">
    </div>
  </div>

  <div style="display:flex;gap:8px;margin-top:16px;">
    <button class="btn btn-primary" onclick="saveSettings()">ì €ì¥ ë° ì—°ê²°</button>
    <button class="btn btn-secondary" onclick="closeSettings()">ì·¨ì†Œ</button>
  </div>

  <div style="margin-top:20px;padding:14px;background:var(--bg);border-radius:8px;">
    <p style="font-size:12px;color:var(--text-sub);line-height:1.6;">
      <strong>ğŸ“Œ ì—°ê²° ë°©ë²• (3ë‹¨ê³„):</strong><br>
      â‘  Google Cloud Consoleì—ì„œ API í‚¤ ìƒì„±<br>
      â‘¡ Google Sheets API í™œì„±í™”<br>
      â‘¢ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ë¥¼ "ë§í¬ê°€ ìˆëŠ” ëª¨ë“  ì‚¬ìš©ì" ê³µê°œ<br><br>
      ìì„¸í•œ ë°©ë²•ì€ í•¨ê»˜ ì œê³µëœ ê°€ì´ë“œë¥¼ ì°¸ê³ í•˜ì„¸ìš”.
    </p>
  </div>
</div>

<script>
// ============================================
// STATE
// ============================================
let curDate = new Date(2026, 2, 1); // March 2026
let curSec = 'schedule';
let schViewMode = 'card';

let cfg = {
  apiKey: '', sheetId: '',
  sheetNames: { schedule:'ê²Œì‹œì˜ˆì •ì½˜í…ì¸ ', filming:'ì˜ìƒì¤€ë¹„í˜„í™©', editing:'í¸ì§‘í˜„í™©', upload:'ì—…ë¡œë“œí˜„í™©', board:'ê²Œì‹œíŒ' }
};

let D = { schedule:[], filming:[], editing:[], upload:[], board:[] };

// ============================================
// INIT
// ============================================
document.addEventListener('DOMContentLoaded', () => {
  loadCfg();
  updMonth();
  if (cfg.apiKey && cfg.sheetId) { fetchAll(); }
  else { loadDemo(); renderAll(); }
});

// ============================================
// CONFIG
// ============================================
function loadCfg() {
  const s = localStorage.getItem('vdashCfg3');
  if (s) { cfg = JSON.parse(s); }
  document.getElementById('cfgApiKey').value = cfg.apiKey||'';
  document.getElementById('cfgSheetId').value = cfg.sheetId||'';
  document.getElementById('snSchedule').value = cfg.sheetNames?.schedule||'ê²Œì‹œì˜ˆì •ì½˜í…ì¸ ';
  document.getElementById('snFilming').value = cfg.sheetNames?.filming||'ì˜ìƒì¤€ë¹„í˜„í™©';
  document.getElementById('snEditing').value = cfg.sheetNames?.editing||'í¸ì§‘í˜„í™©';
  document.getElementById('snUpload').value = cfg.sheetNames?.upload||'ì—…ë¡œë“œí˜„í™©';
  document.getElementById('snBoard').value = cfg.sheetNames?.board||'ê²Œì‹œíŒ';
}

function saveSettings() {
  cfg.apiKey = document.getElementById('cfgApiKey').value.trim();
  cfg.sheetId = document.getElementById('cfgSheetId').value.trim();
  cfg.sheetNames = {
    schedule: document.getElementById('snSchedule').value.trim()||'ê²Œì‹œì˜ˆì •ì½˜í…ì¸ ',
    filming: document.getElementById('snFilming').value.trim()||'ì˜ìƒì¤€ë¹„í˜„í™©',
    editing: document.getElementById('snEditing').value.trim()||'í¸ì§‘í˜„í™©',
    upload: document.getElementById('snUpload').value.trim()||'ì—…ë¡œë“œí˜„í™©',
    board: document.getElementById('snBoard').value.trim()||'ê²Œì‹œíŒ'
  };
  localStorage.setItem('vdashCfg3', JSON.stringify(cfg));
  closeSettings();
  fetchAll();
}

function openSettings(){document.getElementById('setPanel').classList.add('active');document.getElementById('setOverlay').classList.add('active');}
function closeSettings(){document.getElementById('setPanel').classList.remove('active');document.getElementById('setOverlay').classList.remove('active');}

// ============================================
// NAV
// ============================================
const titles = {schedule:'ê²Œì‹œì˜ˆì • ì½˜í…ì¸ ',filming:'ì›”ê°„ ì˜ìƒì¤€ë¹„í˜„í™©',editing:'ì›”ê°„ í¸ì§‘í˜„í™©',upload:'ì˜ìƒ ì—…ë¡œë“œí˜„í™©',board:'ì˜ìƒì—…ë¬´ê´€ë ¨ê²Œì‹œíŒ'};
function go(id){
  curSec=id;
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  document.getElementById('sec-'+id).classList.add('active');
  document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));
  document.querySelector(`[data-section="${id}"]`).classList.add('active');
  document.getElementById('headerTitle').textContent=titles[id];
  document.getElementById('sidebar').classList.remove('open');
  document.getElementById('sidebarOverlay').classList.remove('active');
  render(id);
}
function toggleSidebar(){document.getElementById('sidebar').classList.toggle('open');document.getElementById('sidebarOverlay').classList.toggle('active');}

// ============================================
// MONTH
// ============================================
function chgMonth(d){curDate.setMonth(curDate.getMonth()+d);updMonth();renderAll();}
function updMonth(){document.getElementById('monthDisp').textContent=`${curDate.getFullYear()}ë…„ ${curDate.getMonth()+1}ì›”`;}
function ym(){return{y:curDate.getFullYear(),m:curDate.getMonth()};}

// ============================================
// UTIL
// ============================================
function fmtDate(s){if(!s)return'-';const d=new Date(s);if(isNaN(d))return s;return`${d.getFullYear()}.${String(d.getMonth()+1).padStart(2,'0')}.${String(d.getDate()).padStart(2,'0')}`;}
function dayName(s){if(!s)return'';const d=new Date(s);if(isNaN(d))return'';return['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '][d.getDay()];}
function inMonth(s,y,m){if(!s)return false;const d=new Date(s);return!isNaN(d)&&d.getFullYear()===y&&d.getMonth()===m;}
function inYear(s,y){if(!s)return false;const d=new Date(s);return!isNaN(d)&&d.getFullYear()===y;}
function chkIcon(v){return v?'<i class="fas fa-check chk chk-y"></i>':'<i class="fas fa-minus chk chk-n"></i>';}
function catBadge(c){if(!c)return'';return`<span class="cat-badge cat-${c}">${c}</span>`;}
function gubBadge(g){if(!g)return'-';return`<span class="gub-${g}">${g}</span>`;}
function fieldBadge(f){if(!f)return'';return`<span class="b-field b-${f}">${f}</span>`;}
function statusBadge(s){if(!s)return'';if(s==='ì™„ë£Œ')return'<span class="badge badge-complete">ì™„ë£Œ</span>';if(s==='ì˜ˆì •')return'<span class="badge badge-pending">ì˜ˆì •</span>';if(s==='ì·¨ì†Œ')return'<span class="badge badge-cancel">ì·¨ì†Œ</span>';return`<span class="badge">${s}</span>`;}
function popFieldFilter(selId,arr,key){const el=document.getElementById(selId);const cv=el.value;const fs=[...new Set(arr.map(r=>r[key]).filter(Boolean))].sort();el.innerHTML='<option value="all">ì „ì²´ ë¶„ì•¼</option>'+fs.map(f=>`<option value="${f}">${f}</option>`).join('');el.value=fs.includes(cv)?cv:'all';}
function applyFilter(rows,fId,gId,fk,gk){const fv=document.getElementById(fId).value;const gv=document.getElementById(gId).value;return rows.filter(r=>(fv==='all'||r[fk]===fv)&&(gv==='all'||r[gk]===gv));}

// ============================================
// DATA FETCH
// ============================================
async function fetchSheet(name){
  const url=`https://sheets.googleapis.com/v4/spreadsheets/${cfg.sheetId}/values/${encodeURIComponent(name)}?key=${cfg.apiKey}`;
  try{const r=await fetch(url);if(!r.ok)throw new Error(r.status);const j=await r.json();return j.values||[];}catch(e){console.error(name,e);return[];}
}
function parseSheet(v){if(!v||v.length<2)return[];const h=v[0];return v.slice(1).map(r=>{const o={};h.forEach((k,i)=>{o[k]=r[i]||'';});return o;});}

async function fetchAll(){
  const st=document.getElementById('connSt');
  try{
    const [sv,fv,ev,uv,bv]=await Promise.all([
      fetchSheet(cfg.sheetNames.schedule),
      fetchSheet(cfg.sheetNames.filming),
      fetchSheet(cfg.sheetNames.editing),
      fetchSheet(cfg.sheetNames.upload),
      fetchSheet(cfg.sheetNames.board)
    ]);
    D.schedule=parseSheet(sv).map(r=>({...r,'ì˜ìƒ':r['ì˜ìƒ']==='Y'||r['ì˜ìƒ']==='âœ“','ì˜¤ë””ì˜¤':r['ì˜¤ë””ì˜¤']==='Y'||r['ì˜¤ë””ì˜¤']==='âœ“','HTML':r['HTML']==='Y'||r['HTML']==='âœ“','PDF':r['PDF']==='Y'||r['PDF']==='âœ“','PPT':r['PPT']==='Y'||r['PPT']==='âœ“','ê²Œì‹œì™„ë£Œ':r['ê²Œì‹œì™„ë£Œ']==='Y'||r['ê²Œì‹œì™„ë£Œ']==='âœ“'}));
    D.filming=parseSheet(fv);
    D.editing=parseSheet(ev);
    D.upload=parseSheet(uv);
    D.board=parseSheet(bv);
    st.className='conn-status ok';st.innerHTML='<div class="conn-dot"></div><span>ì—°ê²°ë¨</span>';
    renderAll();
  }catch(e){
    console.error(e);
    st.className='conn-status fail';st.innerHTML='<div class="conn-dot"></div><span>ì—°ê²° ì‹¤íŒ¨</span>';
  }
}

// ============================================
// RENDER
// ============================================
function renderAll(){render(curSec);}
function render(id){
  switch(id){
    case'schedule':renderSchedule();break;case'filming':renderFilming();break;
    case'editing':renderEditing();break;case'upload':renderUpload();break;case'board':renderBoard();break;
  }
}

// --- 1. ê²Œì‹œì˜ˆì • ì½˜í…ì¸  ---
function schView(m){
  schViewMode=m;
  document.querySelectorAll('.vt-btn').forEach(b=>b.classList.remove('active'));
  document.querySelector(`.vt-btn[data-view="${m}"]`).classList.add('active');
  document.getElementById('schCardWrap').style.display=m==='card'?'block':'none';
  document.getElementById('schListWrap').style.display=m==='list'?'block':'none';
  renderSchedule();
}

function renderSchedule(){
  const{y,m}=ym();
  let rows=D.schedule.filter(r=>inMonth(r['ê²Œì‹œì˜ˆì •ì¼'],y,m)).sort((a,b)=>(a['ê²Œì‹œì˜ˆì •ì¼']||'').localeCompare(b['ê²Œì‹œì˜ˆì •ì¼']||''));
  const total=rows.length;
  const published=rows.filter(r=>r['ê²Œì‹œì™„ë£Œ']).length;

  // Filter
  const catV=document.getElementById('schCatF').value;
  const gubV=document.getElementById('schGubF').value;
  if(catV!=='all')rows=rows.filter(r=>r['ì¹´í…Œê³ ë¦¬']===catV);
  if(gubV!=='all')rows=rows.filter(r=>r['êµ¬ë¶„']===gubV);

  document.getElementById('schSum').innerHTML=`
    <div class="sum-item a-blue">ì´ í¸ì„± <strong>${total}</strong>ê±´</div>
    <div class="sum-item a-green">ê²Œì‹œì™„ë£Œ <strong>${published}</strong>ê±´</div>
    <div class="sum-item a-red">ê²Œì‹œì „ <strong>${total-published}</strong>ê±´</div>
    <div class="sum-item">í˜„ì¬ í‘œì‹œ <strong>${rows.length}</strong>ê±´</div>
  `;

  // Cards
  const cc=document.getElementById('schCards');
  if(!rows.length){cc.innerHTML='<div class="empty-state"><i class="fas fa-calendar-times"></i><p>í•´ë‹¹ ì›” ê²Œì‹œì˜ˆì • ì½˜í…ì¸ ê°€ ì—†ìŠµë‹ˆë‹¤.</p></div>';}
  else{cc.innerHTML=rows.map(r=>{
    const dn=dayName(r['ê²Œì‹œì˜ˆì •ì¼']);
    const dc=new Date(r['ê²Œì‹œì˜ˆì •ì¼']).getDay();
    const dayC=dc===1?'day-mon':dc===3?'day-wed':dc===5?'day-fri':'';
    return`<div class="c-card border-${r['ì¹´í…Œê³ ë¦¬']||''}">
      <div class="c-card-top">
        <span class="c-card-date">${fmtDate(r['ê²Œì‹œì˜ˆì •ì¼'])} <span class="day-badge ${dayC}" style="display:inline-block;padding:1px 6px;border-radius:4px;font-size:10px;font-weight:700;">${dn}</span></span>
        ${catBadge(r['ì¹´í…Œê³ ë¦¬'])}
      </div>
      <div class="c-card-title">${r['ì œëª©']||'-'}</div>
      <div class="c-card-meta">${gubBadge(r['êµ¬ë¶„'])}</div>
      <div class="c-card-checks">
        <span class="ci">${chkIcon(r['ì˜ìƒ'])} ì˜ìƒ</span>
        <span class="ci">${chkIcon(r['ì˜¤ë””ì˜¤'])} ì˜¤ë””ì˜¤</span>
        <span class="ci">${chkIcon(r['HTML'])} HTML</span>
        <span class="ci">${chkIcon(r['PDF'])} PDF</span>
        <span class="ci">${chkIcon(r['PPT'])} PPT</span>
        <span class="ci" style="font-weight:600;${r['ê²Œì‹œì™„ë£Œ']?'color:var(--success)':'color:var(--danger)'}">${r['ê²Œì‹œì™„ë£Œ']?'<i class="fas fa-check chk chk-y"></i> ê²Œì‹œì™„ë£Œ':'<i class="fas fa-clock chk chk-n"></i> ê²Œì‹œì „'}</span>
      </div>
    </div>`; }).join('');}

  // Table
  const tb=document.getElementById('schTbl');
  if(!rows.length){tb.innerHTML='<tr><td colspan="10" class="empty-state"><p>ë°ì´í„° ì—†ìŒ</p></td></tr>';}
  else{tb.innerHTML=rows.map(r=>`<tr>
    <td>${fmtDate(r['ê²Œì‹œì˜ˆì •ì¼'])}</td><td>${catBadge(r['ì¹´í…Œê³ ë¦¬'])}</td><td>${gubBadge(r['êµ¬ë¶„'])}</td>
    <td>${r['ì œëª©']||'-'}</td>
    <td class="center">${chkIcon(r['ì˜ìƒ'])}</td><td class="center">${chkIcon(r['ì˜¤ë””ì˜¤'])}</td>
    <td class="center">${chkIcon(r['HTML'])}</td><td class="center">${chkIcon(r['PDF'])}</td>
    <td class="center">${chkIcon(r['PPT'])}</td>
    <td class="center">${r['ê²Œì‹œì™„ë£Œ']?'<span class="badge badge-complete">ê²Œì‹œì™„ë£Œ</span>':'<span class="badge badge-cancel">ê²Œì‹œì „</span>'}</td>
  </tr>`).join('');}
}

// --- 2. ì›”ê°„ ì˜ìƒì¤€ë¹„í˜„í™© ---
function renderFilming(){
  const{y,m}=ym();
  popFieldFilter('filmFieldF',D.filming,'ë¶„ì•¼');
  const all=D.filming.filter(r=>inMonth(r['ì˜ìƒí™•ë³´ì˜ˆì •ì¼'],y,m));
  let rows=applyFilter([...all].sort((a,b)=>(a['ì˜ìƒí™•ë³´ì˜ˆì •ì¼']||'').localeCompare(b['ì˜ìƒí™•ë³´ì˜ˆì •ì¼']||'')),'filmFieldF','filmGubF','ë¶„ì•¼','êµ¬ë¶„');
  const done=all.filter(r=>r['ì¤€ë¹„ìƒíƒœ']==='ì™„ë£Œ').length;
  const pend=all.filter(r=>r['ì¤€ë¹„ìƒíƒœ']==='ì˜ˆì •').length;
  const yrDone=D.filming.filter(r=>inYear(r['ì˜ìƒí™•ë³´ì˜ˆì •ì¼'],y)&&r['ì¤€ë¹„ìƒíƒœ']==='ì™„ë£Œ').length;

  document.getElementById('filmSum').innerHTML=`
    <div class="sum-item a-blue">ë‹¹ì›” í•©ê³„ <strong>${all.length}</strong>ê±´</div>
    <div class="sum-item a-green">ì™„ë£Œ <strong>${done}</strong>ê±´</div>
    <div class="sum-item a-yellow">ì˜ˆì • <strong>${pend}</strong>ê±´</div>
    <div class="sum-item bordered">ë‹¹ì›” ì¤€ë¹„ì™„ë£Œì˜ìƒê³„ <strong>${done}</strong></div>
    <div class="sum-item bordered-g">ì—°ê°„ ì¤€ë¹„ì™„ë£Œì˜ìƒê³„ <strong>${yrDone}</strong></div>
  `;
  const tb=document.getElementById('filmTbl');
  if(!rows.length){tb.innerHTML='<tr><td colspan="8" class="empty-state"><p>ë°ì´í„° ì—†ìŒ</p></td></tr>';}
  else{tb.innerHTML=rows.map(r=>`<tr>
    <td>${fmtDate(r['ì˜ìƒí™•ë³´ì˜ˆì •ì¼'])}</td><td>${fieldBadge(r['ë¶„ì•¼'])}</td><td>${gubBadge(r['êµ¬ë¶„'])}</td>
    <td>${r['ì „ë¬¸ê°€']||'-'}</td><td>${r['ì˜ìƒì œëª©']||'-'}</td><td>${statusBadge(r['ì¤€ë¹„ìƒíƒœ'])}</td>
    <td>${fmtDate(r['ì˜ìƒì—…ë¡œë“œì¼'])}</td><td>${r['ë¹„ê³ ']||''}</td>
  </tr>`).join('');}
}

// --- 3. ì›”ê°„ í¸ì§‘í˜„í™© ---
function renderEditing(){
  const{y,m}=ym();
  const fc=D.filming.filter(r=>r['ì¤€ë¹„ìƒíƒœ']==='ì™„ë£Œ'&&inMonth(r['ì˜ìƒí™•ë³´ì˜ˆì •ì¼'],y,m));
  const eMap={};D.editing.forEach(r=>{eMap[`${r['ì˜ìƒí™•ë³´ì¼']}_${r['ì „ë¬¸ê°€']}_${r['ì˜ìƒì œëª©']}`]=r;});
  let rows=fc.map(f=>{
    const k=`${f['ì˜ìƒí™•ë³´ì˜ˆì •ì¼']}_${f['ì „ë¬¸ê°€']}_${f['ì˜ìƒì œëª©']}`;const e=eMap[k];
    return{'ì˜ìƒí™•ë³´ì¼':f['ì˜ìƒí™•ë³´ì˜ˆì •ì¼'],'ë¶„ì•¼':f['ë¶„ì•¼'],'êµ¬ë¶„':f['êµ¬ë¶„']||'','ì „ë¬¸ê°€':f['ì „ë¬¸ê°€'],'ì˜ìƒì œëª©':f['ì˜ìƒì œëª©'],'í¸ì§‘ì™„ë£Œì¼':e?e['í¸ì§‘ì™„ë£Œì¼']:'','ì˜ìƒì—…ë¡œë“œì¼':e?e['ì˜ìƒì—…ë¡œë“œì¼']:f['ì˜ìƒì—…ë¡œë“œì¼'],'ë¹„ê³ ':e?e['ë¹„ê³ ']:f['ë¹„ê³ ']};
  });
  D.editing.filter(r=>inMonth(r['ì˜ìƒí™•ë³´ì¼'],y,m)).forEach(r=>{
    if(!rows.find(x=>x['ì˜ìƒí™•ë³´ì¼']===r['ì˜ìƒí™•ë³´ì¼']&&x['ì „ë¬¸ê°€']===r['ì „ë¬¸ê°€']&&x['ì˜ìƒì œëª©']===r['ì˜ìƒì œëª©']))rows.push(r);
  });
  rows.sort((a,b)=>(a['ì˜ìƒí™•ë³´ì¼']||'').localeCompare(b['ì˜ìƒí™•ë³´ì¼']||''));
  popFieldFilter('editFieldF',rows,'ë¶„ì•¼');
  const filtered=applyFilter(rows,'editFieldF','editGubF','ë¶„ì•¼','êµ¬ë¶„');
  const total=rows.length;const edDone=rows.filter(r=>r['í¸ì§‘ì™„ë£Œì¼']).length;
  // ì—°ê°„ ì™„ì„±ì˜ìƒê³„
  const allYrFilm=D.filming.filter(r=>r['ì¤€ë¹„ìƒíƒœ']==='ì™„ë£Œ'&&inYear(r['ì˜ìƒí™•ë³´ì˜ˆì •ì¼'],y));
  let yrEdDone=0;
  allYrFilm.forEach(f=>{const k=`${f['ì˜ìƒí™•ë³´ì˜ˆì •ì¼']}_${f['ì „ë¬¸ê°€']}_${f['ì˜ìƒì œëª©']}`;if(eMap[k]&&eMap[k]['í¸ì§‘ì™„ë£Œì¼'])yrEdDone++;});
  D.editing.filter(r=>inYear(r['ì˜ìƒí™•ë³´ì¼'],y)&&r['í¸ì§‘ì™„ë£Œì¼']).forEach(r=>{
    if(!allYrFilm.find(f=>`${f['ì˜ìƒí™•ë³´ì˜ˆì •ì¼']}_${f['ì „ë¬¸ê°€']}_${f['ì˜ìƒì œëª©']}`===`${r['ì˜ìƒí™•ë³´ì¼']}_${r['ì „ë¬¸ê°€']}_${r['ì˜ìƒì œëª©']}`))yrEdDone++;
  });

  document.getElementById('editSum').innerHTML=`
    <div class="sum-item a-blue">í¸ì§‘ëŒ€ìƒ <strong>${total}</strong>ê±´</div>
    <div class="sum-item a-green">í¸ì§‘ì™„ë£Œ <strong>${edDone}</strong>ê±´</div>
    <div class="sum-item a-yellow">í¸ì§‘ëŒ€ê¸° <strong>${total-edDone}</strong>ê±´</div>
    <div class="sum-item bordered">ë‹¹ì›” ì™„ì„±ì˜ìƒê³„ <strong>${edDone}</strong></div>
    <div class="sum-item bordered-g">ì—°ê°„ ì™„ì„±ì˜ìƒê³„ <strong>${yrEdDone}</strong></div>
  `;
  const tb=document.getElementById('editTbl');
  if(!filtered.length){tb.innerHTML='<tr><td colspan="8" class="empty-state"><p>ë°ì´í„° ì—†ìŒ</p></td></tr>';}
  else{tb.innerHTML=filtered.map(r=>`<tr>
    <td>${fmtDate(r['ì˜ìƒí™•ë³´ì¼'])}</td><td>${fieldBadge(r['ë¶„ì•¼'])}</td><td>${gubBadge(r['êµ¬ë¶„'])}</td>
    <td>${r['ì „ë¬¸ê°€']||'-'}</td><td>${r['ì˜ìƒì œëª©']||'-'}</td>
    <td>${r['í¸ì§‘ì™„ë£Œì¼']?fmtDate(r['í¸ì§‘ì™„ë£Œì¼']):'<span class="badge badge-pending">ëŒ€ê¸°</span>'}</td>
    <td>${fmtDate(r['ì˜ìƒì—…ë¡œë“œì¼'])}</td><td>${r['ë¹„ê³ ']||''}</td>
  </tr>`).join('');}
}

// --- 4. ì˜ìƒ ì—…ë¡œë“œí˜„í™© ---
function renderUpload(){
  const{y,m}=ym();
  const all=D.upload.filter(r=>inMonth(r['ì—…ë¡œë“œì¼'],y,m));
  popFieldFilter('uplFieldF',D.upload,'ë¶„ì•¼');
  let rows=applyFilter([...all].sort((a,b)=>(a['ì—…ë¡œë“œì¼']||'').localeCompare(b['ì—…ë¡œë“œì¼']||'')),'uplFieldF','uplGubF','ë¶„ì•¼','êµ¬ë¶„');
  const yrTotal=D.upload.filter(r=>inYear(r['ì—…ë¡œë“œì¼'],y)).length;

  document.getElementById('uplSum').innerHTML=`
    <div class="sum-item a-blue">ë‹¹ì›” ì´ê³„ <strong>${all.length}</strong>ê±´</div>
    <div class="sum-item bordered-g">ì—°ê°„ ì´ê³„ <strong>${yrTotal}</strong>ê±´</div>
    <div class="sum-item">í˜„ì¬ í‘œì‹œ <strong>${rows.length}</strong>ê±´</div>
  `;
  const tb=document.getElementById('uplTbl');
  if(!rows.length){tb.innerHTML='<tr><td colspan="9" class="empty-state"><p>ë°ì´í„° ì—†ìŒ</p></td></tr>';}
  else{tb.innerHTML=rows.map(r=>`<tr>
    <td>${fmtDate(r['ì—…ë¡œë“œì¼'])}</td><td>${fmtDate(r['ì˜ìƒí™•ë³´ì¼'])}</td><td>${fieldBadge(r['ë¶„ì•¼'])}</td>
    <td>${gubBadge(r['êµ¬ë¶„'])}</td><td>${r['ì£¼ì œ']||'-'}</td><td>${r['ì „ë¬¸ê°€']||'-'}</td><td>${r['ì†Œì†']||'-'}</td>
    <td>${r['ì—…ë¡œë“œì‚¬ì´íŠ¸']||'-'}</td>
    <td>${r['URL']?`<a class="url-link" href="${r['URL']}" target="_blank">ğŸ”— ë§í¬</a>`:'-'}</td>
  </tr>`).join('');}
}

// --- 5. ê²Œì‹œíŒ ---
function renderBoard(){
  const rows=D.board.sort((a,b)=>(b['ê²Œì‹œì¼']||'').localeCompare(a['ê²Œì‹œì¼']||''));
  const list=document.getElementById('boardList');
  if(!rows.length){list.innerHTML='<li class="empty-state"><i class="fas fa-inbox"></i><p>ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</p></li>';return;}
  list.innerHTML=rows.map((r,i)=>`
    <li class="board-item" onclick="openBoard(${i})">
      <div class="board-item-field"><span class="b-field" style="background:#F3F4F6;color:#374151;">${r['ë¶„ì•¼']||'ê¸°íƒ€'}</span></div>
      <div class="board-item-title">${r['ì œëª©']||'(ì œëª© ì—†ìŒ)'}</div>
      <div class="board-item-date">${fmtDate(r['ê²Œì‹œì¼'])}</div>
    </li>`).join('');
}

function openBoard(i){
  const rows=D.board.sort((a,b)=>(b['ê²Œì‹œì¼']||'').localeCompare(a['ê²Œì‹œì¼']||''));
  const r=rows[i];if(!r)return;
  document.getElementById('mTitle').textContent=r['ì œëª©']||'';
  document.getElementById('mField').innerHTML=`<span class="b-field" style="background:#F3F4F6;color:#374151;">${r['ë¶„ì•¼']||'ê¸°íƒ€'}</span>`;
  document.getElementById('mDate').textContent=fmtDate(r['ê²Œì‹œì¼']);
  document.getElementById('mContent').textContent=r['ë‚´ìš©']||'';
  document.getElementById('boardModal').classList.add('active');
}
function closeModal(){document.getElementById('boardModal').classList.remove('active');}
document.getElementById('boardModal').addEventListener('click',e=>{if(e.target===e.currentTarget)closeModal();});

// ============================================
// DEMO DATA (JARVIA 3ì›” ê¸°ì¤€)
// ============================================
function loadDemo(){
  // Google Sheets ì—°ê²° ì „ì—ëŠ” ëª¨ë“  ë©”ë‰´ê°€ ë¹ˆ ìƒíƒœë¡œ í‘œì‹œë©ë‹ˆë‹¤.
  // ì„¤ì •ì—ì„œ Google Sheets API í‚¤ì™€ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ IDë¥¼ ì…ë ¥í•˜ë©´ ë°ì´í„°ê°€ í‘œì‹œë©ë‹ˆë‹¤.
  D.schedule=[];
  D.filming=[];
  D.editing=[];
  D.upload=[];
  D.board=[];
}
</script>
</body>
</html>
